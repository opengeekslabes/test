{"ast":null,"code":"import { all, call, fork, take, takeEvery, put } from 'redux-saga/effects';\nimport firebase from 'firebase';\nimport { types } from '../actions/autorisation/Types';\nimport { typesPosts } from '../actions/posts/posts';\nimport { typesUser } from '../actions/user/Username';\nimport rsf from '../../rsf/rsf';\nimport { history } from '../../components/App';\nimport { loginSaga } from './autorisation/Login';\nimport { loginGoogleSaga } from './autorisation/LogInGoogle';\nimport { createUserSaga, addUser } from './autorisation/SignUp';\nimport { logoutSaga } from './autorisation/Logout';\nimport { sendPasswordResetEmailSaga } from './autorisation/ResetPassword';\nimport { loginFacebookSaga } from './autorisation/LogInFB';\nimport { createPostSaga } from './posts/posts';\n\nfunction* loginStatusWatcher() {\n  const channel = yield call(rsf.auth.channel);\n\n  while (true) {\n    const {\n      user\n    } = yield take(channel);\n\n    if (user) {\n      console.log(user);\n      yield put({\n        type: typesUser.USERNAME.SUCCESS,\n        email: user.email,\n        name: user.displayName\n      });\n      history.replace('profile');\n    } else {\n      history.replace('/');\n    }\n  }\n}\n\nexport function* loginRootSaga() {\n  yield fork(loginStatusWatcher);\n  yield all([takeEvery(types.LOGIN.ACTION, loginSaga), takeEvery(types.LOGINGOOGLE.REQUEST, loginGoogleSaga), takeEvery(types.SIGNUP.REQUEST, createUserSaga), //    takeEvery(types.SIGNUP.SUCCESS, addUser),\n  takeEvery(types.LOGOUT.REQUEST, logoutSaga), takeEvery(types.RESET.REQUEST, sendPasswordResetEmailSaga), takeEvery(types.LOGINFB.REQUEST, loginFacebookSaga), takeEvery(typesPosts.POST.PUSH, createPostSaga)]);\n}\nexport function* rootSaga() {\n  yield all([fork(loginRootSaga)]);\n}","map":{"version":3,"sources":["C:/Users/Daniil/ТЕСТОВОЕ/test_app/src/redux/sagas/index.js"],"names":["all","call","fork","take","takeEvery","put","firebase","types","typesPosts","typesUser","rsf","history","loginSaga","loginGoogleSaga","createUserSaga","addUser","logoutSaga","sendPasswordResetEmailSaga","loginFacebookSaga","createPostSaga","loginStatusWatcher","channel","auth","user","console","log","type","USERNAME","SUCCESS","email","name","displayName","replace","loginRootSaga","LOGIN","ACTION","LOGINGOOGLE","REQUEST","SIGNUP","LOGOUT","RESET","LOGINFB","POST","PUSH","rootSaga"],"mappings":"AAAA,SAASA,GAAT,EAAcC,IAAd,EAAoBC,IAApB,EAA0BC,IAA1B,EAAgCC,SAAhC,EAA2CC,GAA3C,QAAsD,oBAAtD;AACA,OAAOC,QAAP,MAAqB,UAArB;AACA,SAASC,KAAT,QAAsB,+BAAtB;AACA,SAASC,UAAT,QAA2B,wBAA3B;AACA,SAASC,SAAT,QAA0B,0BAA1B;AACA,OAAOC,GAAP,MAAgB,eAAhB;AACA,SAASC,OAAT,QAAwB,sBAAxB;AACA,SAASC,SAAT,QAA0B,sBAA1B;AACA,SAASC,eAAT,QAAgC,4BAAhC;AACA,SAASC,cAAT,EAAyBC,OAAzB,QAAwC,uBAAxC;AACA,SAASC,UAAT,QAA2B,uBAA3B;AACA,SAASC,0BAAT,QAA2C,8BAA3C;AACA,SAASC,iBAAT,QAAkC,wBAAlC;AACA,SAASC,cAAT,QAA+B,eAA/B;;AAEA,UAAUC,kBAAV,GAA+B;AAC7B,QAAMC,OAAO,GAAG,MAAMpB,IAAI,CAACS,GAAG,CAACY,IAAJ,CAASD,OAAV,CAA1B;;AACA,SAAO,IAAP,EAAa;AACX,UAAM;AAAEE,MAAAA;AAAF,QAAW,MAAMpB,IAAI,CAACkB,OAAD,CAA3B;;AACA,QAAIE,IAAJ,EAAU;AACRC,MAAAA,OAAO,CAACC,GAAR,CAAYF,IAAZ;AACA,YAAMlB,GAAG,CAAC;AAACqB,QAAAA,IAAI,EAAEjB,SAAS,CAACkB,QAAV,CAAmBC,OAA1B;AAAmCC,QAAAA,KAAK,EAAEN,IAAI,CAACM,KAA/C;AAAsDC,QAAAA,IAAI,EAAEP,IAAI,CAACQ;AAAjE,OAAD,CAAT;AACApB,MAAAA,OAAO,CAACqB,OAAR,CAAgB,SAAhB;AACD,KAJD,MAIO;AACLrB,MAAAA,OAAO,CAACqB,OAAR,CAAgB,GAAhB;AACD;AACF;AACF;;AAED,OAAO,UAAUC,aAAV,GAA0B;AAC/B,QAAM/B,IAAI,CAACkB,kBAAD,CAAV;AACA,QAAMpB,GAAG,CAAC,CACRI,SAAS,CAACG,KAAK,CAAC2B,KAAN,CAAYC,MAAb,EAAqBvB,SAArB,CADD,EAERR,SAAS,CAACG,KAAK,CAAC6B,WAAN,CAAkBC,OAAnB,EAA4BxB,eAA5B,CAFD,EAGRT,SAAS,CAACG,KAAK,CAAC+B,MAAN,CAAaD,OAAd,EAAuBvB,cAAvB,CAHD,EAIZ;AACIV,EAAAA,SAAS,CAACG,KAAK,CAACgC,MAAN,CAAaF,OAAd,EAAuBrB,UAAvB,CALD,EAMRZ,SAAS,CAACG,KAAK,CAACiC,KAAN,CAAYH,OAAb,EAAsBpB,0BAAtB,CAND,EAORb,SAAS,CAACG,KAAK,CAACkC,OAAN,CAAcJ,OAAf,EAAwBnB,iBAAxB,CAPD,EAQRd,SAAS,CAACI,UAAU,CAACkC,IAAX,CAAgBC,IAAjB,EAAuBxB,cAAvB,CARD,CAAD,CAAT;AAUD;AAED,OAAO,UAAUyB,QAAV,GAAqB;AAC1B,QAAM5C,GAAG,CAAC,CAACE,IAAI,CAAC+B,aAAD,CAAL,CAAD,CAAT;AACD","sourcesContent":["import { all, call, fork, take, takeEvery, put } from 'redux-saga/effects'\nimport firebase from 'firebase'\nimport { types } from '../actions/autorisation/Types'\nimport { typesPosts } from '../actions/posts/posts'\nimport { typesUser } from '../actions/user/Username'\nimport rsf from '../../rsf/rsf'\nimport { history } from '../../components/App'\nimport { loginSaga } from './autorisation/Login'\nimport { loginGoogleSaga } from './autorisation/LogInGoogle'\nimport { createUserSaga, addUser } from './autorisation/SignUp'\nimport { logoutSaga } from './autorisation/Logout'\nimport { sendPasswordResetEmailSaga } from './autorisation/ResetPassword'\nimport { loginFacebookSaga } from './autorisation/LogInFB'\nimport { createPostSaga } from './posts/posts'\n\nfunction* loginStatusWatcher() {\n  const channel = yield call(rsf.auth.channel)\n  while (true) {\n    const { user } = yield take(channel)\n    if (user) {\n      console.log(user)\n      yield put({type: typesUser.USERNAME.SUCCESS, email: user.email, name: user.displayName });\n      history.replace('profile')\n    } else {\n      history.replace('/')\n    }\n  }\n}\n\nexport function* loginRootSaga() {\n  yield fork(loginStatusWatcher)\n  yield all([\n    takeEvery(types.LOGIN.ACTION, loginSaga),\n    takeEvery(types.LOGINGOOGLE.REQUEST, loginGoogleSaga),\n    takeEvery(types.SIGNUP.REQUEST, createUserSaga),\n//    takeEvery(types.SIGNUP.SUCCESS, addUser),\n    takeEvery(types.LOGOUT.REQUEST, logoutSaga),\n    takeEvery(types.RESET.REQUEST, sendPasswordResetEmailSaga),\n    takeEvery(types.LOGINFB.REQUEST, loginFacebookSaga),\n    takeEvery(typesPosts.POST.PUSH, createPostSaga),\n  ])\n}\n\nexport function* rootSaga() {\n  yield all([fork(loginRootSaga)])\n}"]},"metadata":{},"sourceType":"module"}